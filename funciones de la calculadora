#include <iostream>
#include <cmath>
#include <stdexcept>

using namespace std;

class Calculadora {
public:
    // sobrecarga de suma
    double sumar(double x, double y) {
        return x + y;
    }
    
    double sumar(double x, double y, double z) {
        return x + y + z;
    }
    
    double restar(double x, double y) {
        return x - y;
    }
    
    double multiplicar(double x, double y) {
        return x * y;
    }
    
    double dividir(double x, double y) {
        if (y == 0) {
            throw invalid_argument("no se puede dividir entre cero");
        }
        return x / y;
    }
    
    // factorial recursivo, el parametro paso es opcional
    long long factorial(int num, bool paso = false) {
        if (num < 0) {
            throw invalid_argument("factorial no valido para negativos");
        }
        if (num == 0 || num == 1) {
            if (paso) cout << num << "! = 1" << endl;
            return 1;
        }
        if (paso) {
            cout << num << "! = " << num << " * " << (num-1) << "!" << endl;
        }
        return num * factorial(num - 1, paso);
    }
    
    // potencia con exponente por defecto en 2
    double potencia(double base, int exp = 2) {
        return pow(base, exp);
    }
    
    double raizCuadrada(double val) {
        if (val < 0) {
            throw invalid_argument("raiz de negativo no existe");
        }
        return sqrt(val);
    }
    
    // raiz con indice por defecto en 2
    double raiz(double val, int ind = 2) {
        if (val < 0 && ind % 2 == 0) {
            throw invalid_argument("raiz par de negativo no existe");
        }
        if (ind == 0) {
            throw invalid_argument("indice no puede ser cero");
        }
        return pow(val, 1.0 / ind);
    }
};

int main() {
    Calculadora miCalc;
    int op;
    double a, b, c, res;
    int e, ind;
    char r;
    
    do {
        cout << "\n--- CALCULADORA ---" << endl;
        cout << "1. Suma" << endl;
        cout << "2. Resta" << endl;
        cout << "3. Multiplicacion" << endl;
        cout << "4. Division" << endl;
        cout << "5. Factorial" << endl;
        cout << "6. Potencia" << endl;
        cout << "7. Raiz cuadrada" << endl;
        cout << "8. Raiz n-esima" << endl;
        cout << "0. Salir" << endl;
        cout << "Opcion: ";
        cin >> op;

 try {
            switch (op) {
                case 1:
                    cout << "Cuantos numeros? (2/3): ";
                    cin >> r;
                    cout << "Numero 1: ";
                    cin >> a;
                    cout << "Numero 2: ";
                    cin >> b;
                    if (r == '3') {
                        cout << "Numero 3: ";
                        cin >> c;
                        res = miCalc.sumar(a, b, c);
                    } else {
                        res = miCalc.sumar(a, b);
                    }
                    cout << "Resultado: " << res << endl;
                    break;
                    
                case 2:
                    cout << "Numero 1: ";
                    cin >> a;
                    cout << "Numero 2: ";
                    cin >> b;
                    res = miCalc.restar(a, b);
                    cout << "Resultado: " << res << endl;
                    break;
                    
                case 3:
                    cout << "Numero 1: ";
                    cin >> a;
                    cout << "Numero 2: ";
                    cin >> b;
                    res = miCalc.multiplicar(a, b);
                    cout << "Resultado: " << res << endl;
                    break;
                    
                case 4:
                    cout << "Dividendo: ";
                    cin >> a;
                    cout << "Divisor: ";
                    cin >> b;
                    res = miCalc.dividir(a, b);
                    cout << "Resultado: " << res << endl;
                    break;
                    
                case 5:
                    cout << "Numero: ";
                    cin >> e;
                    cout << "Ver pasos? (s/n): ";
                    cin >> r;
                    if (r == 's') {
                        res = miCalc.factorial(e, true);
                    } else {
                        res = miCalc.factorial(e);
                    }
                    cout << "Resultado: " << res << endl;
                    break;
                    
                case 6:
                    cout << "Base: ";
                    cin >> a;
                    cout << "Usar exponente 2? (s/n): ";
                    cin >> r;
                    if (r == 's') {
                        res = miCalc.potencia(a);
                    } else {
                        cout << "Exponente: ";
                        cin >> e;
                        res = miCalc.potencia(a, e);
                    }
                    cout << "Resultado: " << res << endl;
                    break;
                    
                case 7:
                    cout << "Numero: ";
                    cin >> a;
                    res = miCalc.raizCuadrada(a);
                    cout << "Resultado: " << res << endl;
                    break;
                    
                case 8:
                    cout << "Numero: ";
                    cin >> a;
                    cout << "Usar indice 2? (s/n): ";
                    cin >> r;
                    if (r == 's') {
                        res = miCalc.raiz(a);
                    } else {
                        cout << "Indice: ";
                        cin >> ind;
                        res = miCalc.raiz(a, ind);
                    }
                    cout << "Resultado: " << res << endl;
                    break;
                    
                case 0:
                    cout << "Adios" << endl;
                    break;
                    
                default:
                    cout << "opcion invalida" << endl;
            }
            
        } catch (const exception& error) {
            cout << "Error: " << error.what() << endl;
        }
        
    } while (op != 0);
    
    return 0;
}
